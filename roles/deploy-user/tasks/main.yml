# - name: create template
#   local_action: template src=auth dest=fetch/auth

- name: fetch tinc hosts file after key creation
  fetch: >
    src={{taskd_certs_path}}/{{ item }}
    dest=fetch/{{ item }}
    flat=yes
  with_items:
    - ca.cert.pem
    - "{{taskd_client_cert_name}}.cert.pem"
    - "{{taskd_client_cert_name}}.key.pem"

- name: sync the fetched tinc hosts files on each host
  synchronize: >
    src=fetch/
    dest=~/.task/

# TODO install taskd on clients. can fork on os, use package module for task.
